!function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};this.SearchView=function(s){function n(){return this.$selectedResult=e(this.$selectedResult,this),this.$results=e(this.$results,this),this.renderResults=e(this.renderResults,this),this.resetResults=e(this.resetResults,this),this.val=e(this.val,this),this.focus=e(this.focus,this),this.goTo=e(this.goTo,this),this.goToSelected=e(this.goToSelected,this),this.highlightSelected=e(this.highlightSelected,this),this.moveDown=e(this.moveDown,this),this.moveUp=e(this.moveUp,this),this.handleEscape=e(this.handleEscape,this),this.onKeyUp=e(this.onKeyUp,this),this.onKeyDown=e(this.onKeyDown,this),this.initialize=e(this.initialize,this),t=n.__super__.constructor.apply(this,arguments)}return i(n,s),n.prototype.el=".search-form",n.prototype.events={"keydown [name=search]":"onKeyDown","keyup [name=search]":"onKeyUp","focus [name=search]":"renderResults"},n.prototype.initialize=function(){return this.$input=this.$el.find("[name=search]"),this.$resultsContainer=this.$el.find(".results"),this.resetResults(),this.focus()},n.prototype.onKeyDown=function(t){var e;return(e=t.keyCode)===KeyCode.DOWN||e===KeyCode.UP?t.preventDefault():void 0},n.prototype.onKeyUp=function(t){switch(t.keyCode){case KeyCode.ESCAPE:return this.handleEscape();case KeyCode.DOWN:return this.moveDown(t);case KeyCode.UP:return this.moveUp(t);case KeyCode.ENTER:return this.goToSelected();default:return this.renderResults()}},n.prototype.handleEscape=function(){return null!=this.val()?(this.$input.val(""),this.resetResults()):this.$input.blur()},n.prototype.moveUp=function(){var t;return(t=this.$selectedResult())?(t.is(":first-child")?this.selectedIndex=null:this.selectedIndex-=1,this.highlightSelected()):void 0},n.prototype.moveDown=function(){var t;return t=this.$selectedResult(),t?t.is(":last-child")||(this.selectedIndex+=1):this.selectedIndex=1,this.highlightSelected()},n.prototype.highlightSelected=function(){var t;return this.$results().removeClass("active"),null!=(t=this.$selectedResult())?t.addClass("active"):void 0},n.prototype.goToSelected=function(){var t;return t=this.$selectedResult(),t?this.goTo(t.attr("href")):void 0},n.prototype.goTo=function(t){return window.location.pathname=t},n.prototype.focus=function(){return this.$input.focus(),this.renderResults()},n.prototype.val=function(){var t;return t=$.trim(this.$input.val()),""===t?null:t},n.prototype.resetResults=function(){return this.selectedIndex=null,this.$resultsContainer.html("")},n.prototype.renderResults=function(){var t,e,s,i,n,r;if(this.resetResults(),s=["box-sizing","box-shadow","border-radius","text-shadow","border-width","border-left","border"],null!=this.val()){if(e=fuzzyMatch(s,this.val()),e.length>0){for(r=[],i=0,n=e.length;n>i;i++)t=e[i],r.push($("<a class='result' href='/"+t.match+"/'/>").html(t.highlighted).appendTo(this.$resultsContainer));return r}return this.$resultsContainer.text("No results")}},n.prototype.$results=function(){return this.$resultsContainer.find("a")},n.prototype.$selectedResult=function(){var t;if(this.selectedIndex)return t=this.$results().filter(":nth-child("+this.selectedIndex+")"),t.length>0?t:null},n}(Backbone.View)}.call(this);